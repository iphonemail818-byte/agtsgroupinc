<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>AGTS Booking</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<style>
* { box-sizing: border-box; }
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  overflow: hidden;
  background: url("https://raw.githubusercontent.com/iphonemail818-byte/agtsgroupinc/main/IMG_6201.png") center/cover no-repeat fixed;
  color: #fff;
}

/* HEADER / BURGER */
.header {
  position: fixed;
  top: 16px;
  left: 16px;
  z-index: 50;
}
.burger {
  width: 22px;
  height: 16px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  cursor: pointer;
}
.burger span {
  height: 2px;
  width: 100%;
  background: #fff;
  border-radius: 2px;
}

/* MENU */
.menu {
  position: fixed;
  top: 0;
  left: 0;
  width: 260px;
  height: 100%;
  background: rgba(11,11,16,0.95);
  transform: translateX(-100%);
  transition: 0.3s;
  z-index: 60;
  padding: 80px 20px;
}
.menu.open { transform: translateX(0); }
.menu a {
  display: block;
  color: #fff;
  text-decoration: none;
  padding: 14px 0;
  border-bottom: 1px solid #222;
}
.menu-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  opacity: 0;
  pointer-events: none;
  transition: .25s;
  z-index: 55;
}
.menu-backdrop.show { opacity:1; pointer-events:auto; }

/* STEP CONTAINER */
.container {
  max-width: 520px;
  margin: 120px auto 0;
  padding: 16px;
}
.card {
  background: rgba(15,15,20,.95);
  border-radius: 22px;
  padding: 20px;
  box-shadow: 0 25px 50px rgba(0,0,0,.7);
  margin-bottom: 16px;
}

/* FIELDS */
.field {
  margin-bottom: 18px;
  position: relative;
}
.field label {
  display: block;
  font-size: .7em;
  letter-spacing: .12em;
  opacity: .6;
  margin-bottom: 6px;
}
.field input {
  width: 100%;
  padding: 14px 16px;
  font-size: 16px;
  border-radius: 14px;
  border: 1px solid #333;
  background: #111;
  color: #fff;
}

/* CURRENT LOCATION BUTTON */
.loc-btn {
  position: absolute;
  right: 10px;
  top: 34px;
  background: #222;
  border: none;
  color: #9ca3af;
  font-size: 13px;
  padding: 6px 10px;
  border-radius: 10px;
  cursor: pointer;
}

/* CONFIRMED FIELDS / TRIP REVIEW */
.confirmed {
  margin-top: 2in; /* 2 inches below shadow */
  font-size: 1em;
  color: #0ff; /* cyan */
  cursor: pointer;
  border-bottom: 1px dashed #0ff;
  padding-bottom: 4px;
}
.distance-duration {
  margin-top: 12px;
  font-size: 0.9em;
  color: #fff;
}
</style>
</head>
<body>

<!-- HEADER / BURGER -->
<div class="header">
  <div class="burger" id="burger">
    <span></span><span></span><span></span>
  </div>
</div>

<div class="menu" id="menu">
  <a href="#">About</a>
  <a href="#">Log in</a>
  <a href="#">Drivers</a>
  <a href="#">Set up</a>
</div>
<div class="menu-backdrop" id="menuBackdrop"></div>

<!-- STEP-BY-STEP BOOKING -->
<div class="container">
  <!-- Pickup -->
  <div class="card">
    <div class="field">
      <label>PICKUP LOCATION</label>
      <input id="pickup" placeholder="Enter pickup location">
      <button class="loc-btn" id="locBtn">Current</button>
    </div>
    <div id="pickupConfirmed" class="confirmed"></div>
  </div>

  <!-- Destination -->
  <div class="card">
    <div class="field">
      <label>DESTINATION</label>
      <input id="destination" placeholder="Enter destination">
    </div>
    <div id="destConfirmed" class="confirmed"></div>
    <div id="distanceDuration" class="distance-duration"></div>
  </div>

  <!-- Date & Time -->
  <div class="card">
    <div class="field">
      <label>DATE</label>
      <input id="date" readonly>
    </div>
    <div id="dateConfirmed" class="confirmed"></div>

    <div class="field">
      <label>TIME</label>
      <input id="time" readonly>
    </div>
    <div id="timeConfirmed" class="confirmed"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBiBOnLypU6-YGgPruQ2YFZvk3HyaaQ5Ps&libraries=places"></script>
<script>
/* BURGER MENU */
const burger=document.getElementById("burger");
const menu=document.getElementById("menu");
const menuBack=document.getElementById("menuBackdrop");
burger.onclick=()=>{menu.classList.add("open"); menuBack.classList.add("show");};
menuBack.onclick=()=>{menu.classList.remove("open"); menuBack.classList.remove("show");};

/* GOOGLE PLACES AUTOCOMPLETE */
const pickupInput=document.getElementById("pickup");
const destInput=document.getElementById("destination");
const pickupAutocomplete = new google.maps.places.Autocomplete(pickupInput);
const destAutocomplete = new google.maps.places.Autocomplete(destInput);

/* CONFIRMED FIELDS */
const pickupConfirmed=document.getElementById("pickupConfirmed");
const destConfirmed=document.getElementById("destConfirmed");
const dateConfirmed=document.getElementById("dateConfirmed");
const timeConfirmed=document.getElementById("timeConfirmed");
const distanceDuration=document.getElementById("distanceDuration");

/* CURRENT LOCATION BUTTON */
document.getElementById("locBtn").onclick = () => {
  if(!navigator.geolocation){ alert("Location not supported"); return; }

  navigator.geolocation.getCurrentPosition(pos => {
    const latlng = { lat: pos.coords.latitude, lng: pos.coords.longitude };
    const geocoder = new google.maps.Geocoder();

    geocoder.geocode({ location: latlng }, (results, status) => {
      if (status === "OK" && results[0]) {
        pickupInput.value = results[0].formatted_address;
        updateConfirmed('pickup');
      } else { alert("Unable to determine address from location."); }
    });
  }, ()=>{ alert("Location permission denied"); });
};

/* DATE & TIME PICKER */
flatpickr("#date",{minDate:"today", onChange:()=>{updateConfirmed('date');}});
flatpickr("#time",{enableTime:true,noCalendar:true,dateFormat:"h:i K", onChange:()=>{updateConfirmed('time');}});

/* UPDATE CONFIRMED FIELDS FUNCTION */
function updateConfirmed(type){
  if(type==='pickup'){
    pickupConfirmed.textContent = pickupInput.value;
    updateDistance();
  } else if(type==='destination'){
    destConfirmed.textContent = destInput.value;
    updateDistance();
  } else if(type==='date'){
    dateConfirmed.textContent = document.getElementById("date").value;
  } else if(type==='time'){
    timeConfirmed.textContent = document.getElementById("time").value;
  }
}

/* CONFIRMED FIELDS TAPPABLE TO EDIT */
pickupConfirmed.onclick = ()=>{ pickupInput.focus(); };
destConfirmed.onclick = ()=>{ destInput.focus(); };
dateConfirmed.onclick = ()=>{ document.getElementById("date")._flatpickr.open(); };
timeConfirmed.onclick = ()=>{ document.getElementById("time")._flatpickr.open(); };

/* GOOGLE DISTANCE CALCULATION */
function updateDistance(){
  if(pickupInput.value && destInput.value){
    const service = new google.maps.DistanceMatrixService();
    service.getDistanceMatrix({
      origins:[pickupInput.value],
      destinations:[destInput.value],
      travelMode:"DRIVING",
      unitSystem: google.maps.UnitSystem.IMPERIAL
    }, (response, status)=>{
      if(status==="OK"){
        const el=response.rows[0].elements[0];
        distanceDuration.textContent=`Distance: ${el.distance.text}, Duration: ${el.duration.text}`;
      } else {
        distanceDuration.textContent="Distance: Error, Duration: Error";
      }
    });
  }
}

/* AUTOCOMPLETE LISTENERS */
pickupAutocomplete.addListener('place_changed',()=>{ updateConfirmed('pickup'); });
destAutocomplete.addListener('place_changed',()=>{ updateConfirmed('destination'); });
</script>

</body>
</html>